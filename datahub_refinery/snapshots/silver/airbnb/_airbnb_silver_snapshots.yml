snapshots:
          
  - name: 'airbnb_silver_listings'
    config:
      unique_key: '"id"'
      strategy: check
      check_cols:
        - '"id"'
        - '"name"'
        - '"host_id"'
        - '"host_name"'
        - '"neighbourhood_group"'
        - '"neighbourhood"'
        - '"latitude"'
        - '"longitude"'
        - '"room_type"'
        - '"price"'
        - '"minimum_nights"'
        - '"number_of_reviews"'
        - '"last_review"'
        - '"reviews_per_month"'
        - '"calculated_host_listings_count"'
        - '"availability_365"'
        - '"number_of_reviews_ltm"'
        - '"license"'
      custom_access_policy:
        name: CURRENT_YEAR_LESS_REVIEW_ACCESS_POLICY
        columns:
          - last_review
          - number_of_reviews

  - name: 'airbnb_silver_reviews'
    config:
      unique_key: '"id"'
      strategy: check
      check_cols:
        - '"listing_id"'
        - '"id"'
        - '"date"'
        - '"reviewer_id"'
        - '"reviewer_name"'
        - '"comments"'
    columns:
      - name: id
        config:
          custom_masking_policy:
            name: COLUMN_NUMBER_MASKING_POLICY
      - name: comments
        config:
          custom_masking_policy:
            name: COLUMN_VARCHAR_DYNAMIC_MASKING_POLICY
            using:
              - reviewer_name